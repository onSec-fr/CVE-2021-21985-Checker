$url = $args[0]

$headers = New-Object "System.Collections.Generic.Dictionary[[String],[String]]"
$headers.Add("Host", "$url")
$headers.Add("User-Agent", "pentest")
$headers.Add("Content-Type", "application/json")

$body = "{`"methodInput`":[{`"type`":`"ClusterComputeResource`",`"value`": null,`"serverGuid`": null}]}'"
[System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true} ;
$response = Invoke-RestMethod "https://$url/ui/h5-vsan/rest/proxy/service/com.vmware.vsan.client.services.capability.VsanCapabilityProvider/getClusterCapabilityData" -Method 'POST' -Headers $headers -Body $body | ConvertTo-Json
if ($response -like "*result*") 
{ 
    Write-Host -ForegroundColor Red "TARGET VULNERABLE" 
}
else
{
    Write-Host -ForegroundColor Green "TARGET NOT VULNERABLE"
}